!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/platform-browser"),require("rxjs/operators"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-doc-viewer",["exports","@angular/core","@angular/platform-browser","rxjs/operators","rxjs","@angular/common"],r):r((e=e||self)["ngx-doc-viewer"]={},e.ng.core,e.ng.platformBrowser,e.rxjs.operators,e.rxjs,e.ng.common)}(this,(function(e,r,t,n,o,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function l(e,r,t,n){var o,i=arguments.length,l=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(l=(i<3?o(l):i>3?o(r,t,l):o(r,t))||l);return i>3&&l&&Object.defineProperty(r,t,l),l}function s(e,r,t,n){return new(t||(t=Promise))((function(o,i){function l(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t((function(r){r(e.value)})).then(l,s)}a((n=n.apply(e,r||[])).next())}))}function a(e,r){var t,n,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=r.call(e,l)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var u=function(){function e(e,t){this.domSanitizer=e,this.ngZone=t,this.fullUrl=null,this.externalViewer=!1,this.docHtml="",this.configuredViewer="google",this.checkIFrameSubscription=null,this.loaded=new r.EventEmitter,this.url="",this.queryParams="",this.viewerUrl="",this.googleCheckInterval=3e3,this.disableContent="none",this.googleCheckContentLoaded=!0}return e.prototype.ngOnDestroy=function(){this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe()},e.prototype.ngOnChanges=function(e){return s(this,void 0,void 0,(function(){var r,t,i,l,s=this;return a(this,(function(a){switch(a.label){case 0:if(e&&e.viewer&&(e.viewer.isFirstChange||e.viewer.currentValue!==e.viewer.previousValue)&&("google"!==this.viewer&&"office"!==this.viewer&&"mammoth"!==this.viewer&&"pdf"!==this.viewer&&"url"!==this.viewer&&console.error("Unsupported viewer: '"+this.viewer+"'. Supported viewers: google, office, mammoth and pdf"),"mammoth"===this.viewer&&null===mammoth&&console.error("please install mammoth when using local viewer"),this.configuredViewer=this.viewer),"none"!==this.disableContent&&this.viewer,!(e.url&&e.url.currentValue!==e.url.previousValue||e.viewer&&e.viewer.currentValue!==e.viewer.previousValue||e.viewerUrl&&e.viewerUrl.currentValue!==e.viewerUrl.previousValue))return[3,4];switch(e.viewerUrl||(this.viewerUrl=null),this.configuredViewer){case"google":this.viewerUrl="https://docs.google.com/gview?url=%URL%&embedded=true";break;case"office":this.viewerUrl="https://view.officeapps.live.com/op/embed.aspx?src=%URL%";break;case"pdf":this.viewerUrl=null}return this.docHtml="",this.externalViewer="google"===this.configuredViewer||"office"===this.configuredViewer||"url"===this.configuredViewer,this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe(),this.url?[3,1]:(this.fullUrl=null,[3,4]);case 1:return"office"!==this.configuredViewer&&"google"!==this.configuredViewer&&"pdf"!==this.configuredViewer&&"url"!==this.configuredViewer?[3,2]:(r=this.url.indexOf("/")?encodeURIComponent(this.url):this.url,t=this.viewerUrl?this.viewerUrl.replace("%URL%",r):this.url,this.queryParams&&(i=this.queryParams.startsWith("&")?"":"&",t=""+t+i+this.queryParams),this.fullUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(t),"google"===this.configuredViewer&&this.googleCheckContentLoaded&&this.ngZone.runOutsideAngular((function(){var e=document.querySelector("iframe");s.checkIFrame(e),s.checkIFrameSubscription=o.interval(s.googleCheckInterval).pipe(n.take(Math.round(0===s.googleCheckInterval?0:2e4/s.googleCheckInterval))).subscribe((function(){null==e&&(e=document.querySelector("iframe"),s.checkIFrame(e)),s.reloadIFrame(e)}))})),[3,4]);case 2:return"mammoth"!==this.configuredViewer?[3,4]:(mammoth||console.error("Please install mammoth and make sure mammoth.browser.min.js is loaded."),l=this,[4,this.getDocxToHtml(this.url)]);case 3:l.docHtml=a.sent(),a.label=4;case 4:return[2]}}))}))},e.prototype.checkIFrame=function(e){var r=this;e&&(e.onload=function(){r.loaded.emit(null),r.checkIFrameSubscription&&r.checkIFrameSubscription.unsubscribe()})},e.prototype.reloadIFrame=function(e){e&&(console.log("reloading.."),e.src=e.src)},e.prototype.getDocxToHtml=function(e){return s(this,void 0,void 0,(function(){var r;return a(this,(function(t){switch(t.label){case 0:return[4,this.fileToArray(e)];case 1:return r=t.sent(),[4,mammoth.convertToHtml({arrayBuffer:r})];case 2:return[2,t.sent().value]}}))}))},e.prototype.fileToArray=function(e){return new Promise((function(r,t){try{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(){var e=new FileReader;e.readAsArrayBuffer(n.response),e.onloadend=function(t){r(e.result)}},n.send()}catch(r){t("error while retrieving file "+e+".")}}))},e.ctorParameters=function(){return[{type:t.DomSanitizer},{type:r.NgZone}]},l([r.Output()],e.prototype,"loaded",void 0),l([r.Input()],e.prototype,"url",void 0),l([r.Input()],e.prototype,"queryParams",void 0),l([r.Input()],e.prototype,"viewerUrl",void 0),l([r.Input()],e.prototype,"googleCheckInterval",void 0),l([r.Input()],e.prototype,"disableContent",void 0),l([r.Input()],e.prototype,"googleCheckContentLoaded",void 0),l([r.Input()],e.prototype,"viewer",void 0),e=l([r.Component({selector:"ngx-doc-viewer",template:'<ng-container *ngIf="!externalViewer">\r\n    <div\r\n        *ngIf="configuredViewer !== \'pdf\'"\r\n        [innerHtml]="docHtml"\r\n    ></div>\r\n    <embed\r\n        *ngIf="configuredViewer === \'pdf\'"\r\n        type="application/pdf"\r\n        [src]="fullUrl"\r\n        style="width: 100%; height: 100%;"\r\n    />\r\n</ng-container>\r\n<ng-container *ngIf="externalViewer">\r\n    <iframe\r\n        *ngIf="fullUrl && disableContent === \'none\'"\r\n        id="iframe"\r\n        frameBorder="0"\r\n        [src]="fullUrl"\r\n    ></iframe>\r\n    <div\r\n        class="container"\r\n        *ngIf="disableContent !== \'none\'"\r\n    >\r\n        <div\r\n            [class.overlay-full]="disableContent === \'all\'"\r\n            [class.overlay-popout-google]="configuredViewer ===\'google\' && (disableContent === \'popout\' || disableContent === \'popout-hide\')"\r\n            [class.overlay-popout-office]="configuredViewer ===\'office\' && (disableContent === \'popout\' || disableContent === \'popout-hide\')"\r\n            [style.background-color]="disableContent === \'popout-hide\' ? \'#fff\': \'transparent\'"\r\n        >\r\n        </div>\r\n        <iframe\r\n            *ngIf="fullUrl"\r\n            id="iframe"\r\n            frameBorder="0"\r\n            [src]="fullUrl"\r\n        ></iframe>\r\n    </div>\r\n</ng-container>',styles:[":host {\n        display: block;\n    }\n    .container {\n        width: 100%;\n        height: 100%;\n        position: relative;\n    }\n    .overlay-popout-google {\n        width: 40px;\n        height: 40px;\n        right: 26px;\n        top: 11.5px;\n        position: absolute;\n        z-index: 1000;\n    }\n    .overlay-popout-office {\n        width: 100px;\n        height: 20px;\n        right: 0;\n        bottom: 0;\n        position: absolute;\n        z-index: 1000;\n    }\n    .overlay-full {\n        width: 100%;\n        height: 100%;\n        right: 0;\n        top: 0;\n        position: absolute;\n        z-index: 1000;\n    }\n    iframe {\n        width: 100%;\n        height: 100%;\n    }\n    "]})],e)}(),c=function(){function e(){}return e=l([r.NgModule({imports:[i.CommonModule],declarations:[u],exports:[u]})],e)}();e.NgxDocViewerComponent=u,e.NgxDocViewerModule=c,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-doc-viewer.umd.min.js.map